---
title: 【重拾网络】基本概念
date: 2017-07-19 23:25:03
tags:
  - 网络
categories: 网络
---
Netty 还没看几页就碰到 TCP 接收滑块的问题。隐约记得传输层协议学习的时候看过，但也忘的七七八八的了。毕业两年网络相关的知识也差不多丢完了（就好像自己以前会一样），从本文开始回顾一下网络知识。目标至少网络层以上的主要协议大致过程要清楚，尤其是 Web 开发常见协议，总结的顺序依据《计算机网络——自顶向下学习方法》。

## 网络构成

### 网络边缘

- 主机
- 网络应用，模型
  - C/S
  - P2P

### 接入网络

- 目的：将网络边缘接入网络核心（边缘路由器）
- 物理介质：有线、无线通信链路


- 分类：家庭、机构、移动
- 关心主题：带宽、独占 / 共享

#### DSL

- 利用电话线
- 频分多路复用
  - 0 ~ 4HKZ：电话
  - 4KHZ ~ 50KHZ：上行
  - 50KHZ ~ 1MHZ：下行
- 带宽：上行 < 2.5 或 1 Mbps, 下行 > 24 或 10 Mbps
- 独占

#### 电缆

- 电视网络
- 频分多路复用
- HFC：混合光纤同轴电缆
- 带宽：上行 2Mbps，下行 20Mbps
- 共享

#### 以太网

- 机构使用
- 带宽：10Mbps, 100Mbps, 1Gbps, 10Gbps

#### 无线接入

- 共享无线网络
- 无线局域网：802.11 b/g, 11Mbps, 50Mbps
- 广域无线接入

### 网络核心

目的：数据交换，从源主机通过核心网络送到目的主机

#### 互联

- 路由：确定分组从源主机到目的主机的传输路径
- 转发：将分组从路由器输入端口交换至正确的输出端口

#### 结构

网络的网络——Internet

- 端系统通过接入 ISP 连接到 Internet
- ISP 必须进一步互联，构成复杂网络

ISP 互联方式：

1. 直接彼此互联

   需要 N * (N-1) / 2 条连接

2. 每个接入 ISP 连接到一个国家/全球ISP

   引入交换设备简化了方式 1，问题：1. 距离；规模：瓶颈，端口

3. 在方式 2 基础引入竞争者——二级，三级 ISP

   引入交换网络，解决连通性、网络规模问题

4. 引入区域 ISP，连接端系统和接入 ISP

5. 内容提供网络

## 数据交换

- 交换含义：
  1. 动态转义
  2. 动态分配传输资源
- 数据交换方式：电路、报文、分组

### 多路复用技术

- 链路/网络资源划分为资源片
- 将资源片分配给各路呼叫
- 每路呼叫独占分配到的资源进行通信
- 资源可被闲置
- 分配
  - 频分复用 FDM，有先电视网络，占用不同频带
  - 时分复用 TDM，占用不同时间片
  - 波分复用 WDM，光的频分复用
  - 码分复用 CDM，无线链路共享

### 交换技术

#### 电路交换

- 典型：电话网络
- 过程：
  1. 建立连接
  2. 通信
  3. 释放连接
- 特点：独占资源
- 中继线共享——多路复用

#### 报文交换

源（应用）发送信息整体，典型：电报

#### 分组交换

分组：报文拆分出来的较小的数据包

过程：报文拆分、重复

额外开销：1. 拆分，重组；2. 头信息

#### 报文、分组交换异同

- 同：过程都是存储-转发
- 异：交换过程是否查分数据

#### 分组、电路交换特点

- 分组不独占，电路独占资源
- 分组更适合突发数据传输网络
- 分组特点：
  - 无需呼叫建立
  - 资源充分共享
  - 可能产生拥塞：分组延迟，丢失

#### 分组、报文耗时比较

发送 M bits 的报文，链路带宽为 R bps，分组长 L bits，跳步数 h，路由器数 n。（n = h -1）

报文：M / R * h

报文：(M / R) + (h -1) * L / R -> M / R + nL / R

#### 分组交换时延 & 丢包 & 吞吐量

- 时延：结点处理时延、排队时延、传输时延、传播时延

- 流量强度
  
  流量强度：分组 * 分组到达平均速率 / 传输速率

  流量强度 > 1：表示比特到达平均速率超过队列传输出去速率，队列趋于无界增加，排队时延趋于无穷大

- 丢包：到达的分组排满一个队列后，路由器将丢弃分组
  
- 吞吐量：取决于数据流过的链路的传输速率，近似为沿着源和目的地之间路径的最小传输速率

## 网络分层

### TCP/IP 五层模型

|  协议  |               主要作用                |                  关注点                   | 常见协议      | 协议数据单位  | 物理设备    |
| :--: | :-------------------------------: | :------------------------------------: | --------- | ------- | ------- |
| 应用层  |           为应用程序提供网络传输接口           |                 进程如何通信                 | HTTP, DNS | PDU     |         |
| 传输层  |        负责将上层数据分段并提供端到端的传输         |             端到端的差错控制和流量控制              | TCP, UDP  | segment |         |
| 网络层  | 网络地址翻译成对应的物理地 ，解决如何将数据从发送方路由到接收方  |     对子网间的数据包进行路由选择，实现拥塞控制、网际互连等功能      | ARP, IP   | packet  | 路由器     |
| 连接层  | 控制网络层与物理层之间的通信，在不可靠的物理介质上提供可靠的传输。 |      物理地址寻址、数据的成帧、流量控制、数据的检错、重发等       |           | frame   | 交换机，网桥  |
| 物理层  |        为上层协议提供了一个传输数据的物理媒体        | 规定了激活、维持、关闭通信端点之间的机械特性、电气特性、功能特性以及过程特性 |           | bit     | 集线器，中继器 |

为什么强调五层呢？因为还有个 TCP/IP 四层协议把链路层和物理层合并了，统称为网络接口层

### OSI 模型

实际上 TCP/IP 模型是从 OSI 模型演化来的。学院派先搞出的 OSI 模型，工业使用了更简化的 TCP/IP 协议。

具体表现是 TCP/IP 协议把 OSI 的应用层、表示层、会话层合同为应用层。

### 分层的过程：

1. 发送方应用程序的数据总是从最上层开始，层层向下，最终经由物理层发送出去
2. 接收方的物理层接收到数据后，层层向上，最终经由应用层分发到具体的应用程序进程中
3. 在数据层层向下的过程中，每一层都会对数据进行一些封装处理（如打包或者编码）
4. 在数据层层向上的过程中，每一层都会对数据进行一些逆处理（如解包或者解码）
